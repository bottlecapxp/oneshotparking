{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bottlecapmedia/Desktop/Applications/OneShot Parking/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/bottlecapmedia/Desktop/Applications/OneShot Parking/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/bottlecapmedia/Desktop/Applications/OneShot Parking/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useEffect}from'react';import{PaymentContext}from'../Context/PaymentContext';import{CardNumberElement,CardCvcElement,CardExpiryElement,useElements,useStripe}from'@stripe/react-stripe-js';import Lock from'../Assets/lock.png';import CreditCardIcon from\"../Assets/ccIcon.svg\";import axios from'axios';import'../Pages/pages.css';import Loading from'../Components/Loading/Loading';import{withRouter,useHistory}from'react-router-dom';import bodyParser from'body-parser';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var StripePayment=function StripePayment(){// using state to keep track of stripe payment, show errors, and manange user interface\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),success=_useState2[0],setSuccess=_useState2[1];var _useState3=useState({status:\"Enter your card's information below\"}),_useState4=_slicedToArray(_useState3,2),status=_useState4[0],setStatus=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),processing=_useState6[0],setProcessing=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),disabled=_useState8[0],setDisabled=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),clientSecret=_useState10[0],setClientSecrete=_useState10[1];var _useContext=useContext(PaymentContext),userInfo=_useContext.userInfo,totalbilling=_useContext.totalbilling,darkMode=_useContext.darkMode;var _useState11=useState({globalContainer:'global_container',color:'#585858',submitBtn:'submitBtn',card:'card_'}),_useState12=_slicedToArray(_useState11,2),darkModeStyle=_useState12[0],setDarkModeStyle=_useState12[1];var api_data={'fullname':localStorage.getItem('fullname'),'license_plate':localStorage.getItem('license'),'set_time':localStorage.getItem('startTime'),'exp_time':localStorage.getItem('expTime'),'location_id':localStorage.getItem('lot'),'paid':localStorage.getItem('total')};var stripe=useStripe();var element=useElements();var history=useHistory();var CARD_ELEMENT_OPTIONS={style:{base:{color:'white'}}};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _yield$stripe$createP,error,paymentMethod;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.next=3;return stripe.createPaymentMethod({type:'card',card:element.getElement(CardNumberElement,CardExpiryElement,CardCvcElement)});case 3:_yield$stripe$createP=_context.sent;error=_yield$stripe$createP.error;paymentMethod=_yield$stripe$createP.paymentMethod;if(!error){try{setTimeout(function(){history.push('/remaining-time/');},2000);setSuccess(true);// const { id } = paymentMethod\nfetch('https://osparking.pythonanywhere.com/visitor',{method:'POST',mode:'cors',headers:{'Access-Control-Allow-Origin':'*','Content-Type':'application/json'},body:JSON.stringify(api_data)}).then(function(response){return response.json();}).then(function(data){console.log('Success:',data);}).catch(function(error){console.error('Error:',error);});}catch(error){// Change the title information\nsetStatus({status:error});}}case 7:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();// end of handle submit\nuseEffect(function(){if(darkMode>=1800||darkMode<=600){setDarkModeStyle({globalContainer:'global_container_dark',color:'white',submitBtn:'submitBtn_dark',card:'card_dark'});}},[]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(darkModeStyle.globalContainer,\" choose_lot\"),children:stripe?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"global_content_title slim\",style:{textAlign:'center',marginTop:'-50%',color:darkModeStyle.color},children:status.status}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:darkModeStyle.card,children:[\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"stacked_\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:darkModeStyle.color},id:\"CCnumberLabel\",children:\"Enter Your Card Number\"}),/*#__PURE__*/_jsx(\"div\",{id:\"CCnumber\",children:/*#__PURE__*/_jsx(CardNumberElement,{options:CARD_ELEMENT_OPTIONS})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth_holder\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stacked_\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:darkModeStyle.color},children:\"Expiration\"}),/*#__PURE__*/_jsx(\"div\",{id:\"expiration\",children:/*#__PURE__*/_jsx(CardExpiryElement,{options:CARD_ELEMENT_OPTIONS})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stacked_\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:darkModeStyle.color},children:\"CVC\"}),/*#__PURE__*/_jsx(\"div\",{id:\"cvc\",children:/*#__PURE__*/_jsx(CardCvcElement,{options:CARD_ELEMENT_OPTIONS})})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{className:\"ccIcon\",src:CreditCardIcon,alt:\"creditCard_logo\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"securePaymentHolder\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"securePayment_\",children:[\"  \",/*#__PURE__*/_jsx(\"img\",{className:\"lock\",src:Lock}),/*#__PURE__*/_jsx(\"p\",{style:{color:darkModeStyle.color},children:\"Secure Payment\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"ccCardSubmissionHolder\",children:/*#__PURE__*/_jsx(\"input\",{style:success?{color:'green',border:'1px solid green !important'}:{color:'#FF5759',border:'1px solid #FF5759 !important'},className:\"\".concat(darkModeStyle.submitBtn,\" ccCardSubmission\"),type:\"submit\",value:success?'Approved!':'Pay Now'})})]})]}):/*#__PURE__*/_jsx(Loading,{})})});};export default StripePayment;","map":{"version":3,"sources":["/Users/bottlecapmedia/Desktop/Applications/OneShot Parking/src/Stripe/Stripe-CC-Payment.js"],"names":["React","useState","useContext","useEffect","PaymentContext","CardNumberElement","CardCvcElement","CardExpiryElement","useElements","useStripe","Lock","axios","Loading","withRouter","useHistory","bodyParser","StripePayment","success","setSuccess","status","setStatus","processing","setProcessing","disabled","setDisabled","clientSecret","setClientSecrete","userInfo","totalbilling","darkMode","globalContainer","color","submitBtn","card","darkModeStyle","setDarkModeStyle","api_data","localStorage","getItem","stripe","element","history","CARD_ELEMENT_OPTIONS","style","base","handleSubmit","e","preventDefault","createPaymentMethod","type","getElement","error","paymentMethod","setTimeout","push","fetch","method","mode","headers","body","JSON","stringify","then","response","json","data","console","log","catch","textAlign","marginTop","CreditCardIcon","border"],"mappings":"ghBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,UAA1B,CAAsCC,SAAtC,KAAuD,OAAvD,CACA,OAASC,cAAT,KAA+B,2BAA/B,CACA,OAASC,iBAAT,CAA4BC,cAA5B,CAA4CC,iBAA5C,CAA+DC,WAA/D,CAA4EC,SAA5E,KAA6F,yBAA7F,CACA,MAAOC,CAAAA,IAAP,KAAiB,oBAAjB,C,iDAEA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,oBAAP,CACA,MAAOC,CAAAA,OAAP,KAAoB,+BAApB,CACA,OAASC,UAAT,CAAqBC,UAArB,KAAuC,kBAAvC,CACA,MAAOC,CAAAA,UAAP,KAAuB,aAAvB,C,6IAGA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CACxB;AADwB,cAEMf,QAAQ,CAAC,KAAD,CAFd,wCAEjBgB,OAFiB,eAERC,UAFQ,8BAGIjB,QAAQ,CAAC,CACjCkB,MAAM,CAAE,qCADyB,CAAD,CAHZ,yCAGjBA,MAHiB,eAGTC,SAHS,8BAMYnB,QAAQ,CAAC,EAAD,CANpB,yCAMjBoB,UANiB,eAMLC,aANK,8BAOQrB,QAAQ,CAAC,IAAD,CAPhB,yCAOjBsB,QAPiB,eAOPC,WAPO,8BAQiBvB,QAAQ,CAAC,EAAD,CARzB,0CAQjBwB,YARiB,gBAQHC,gBARG,gCASqBxB,UAAU,CAACE,cAAD,CAT/B,CAShBuB,QATgB,aAShBA,QATgB,CASNC,YATM,aASNA,YATM,CASQC,QATR,aASQA,QATR,iBAUkB5B,QAAQ,CAAC,CAC/C6B,eAAe,CAAE,kBAD8B,CAE/CC,KAAK,CAAE,SAFwC,CAG/CC,SAAS,CAAE,WAHoC,CAI/CC,IAAI,CAAE,OAJyC,CAAD,CAV1B,2CAUjBC,aAViB,gBAUFC,gBAVE,gBAiBxB,GAAMC,CAAAA,QAAQ,CAAG,CACb,WAAYC,YAAY,CAACC,OAAb,CAAqB,UAArB,CADC,CAEb,gBAAiBD,YAAY,CAACC,OAAb,CAAqB,SAArB,CAFJ,CAGb,WAAYD,YAAY,CAACC,OAAb,CAAqB,WAArB,CAHC,CAIb,WAAYD,YAAY,CAACC,OAAb,CAAqB,SAArB,CAJC,CAKb,cAAeD,YAAY,CAACC,OAAb,CAAqB,KAArB,CALF,CAMb,OAAQD,YAAY,CAACC,OAAb,CAAqB,OAArB,CANK,CAAjB,CASA,GAAMC,CAAAA,MAAM,CAAG9B,SAAS,EAAxB,CACA,GAAM+B,CAAAA,OAAO,CAAGhC,WAAW,EAA3B,CACA,GAAMiC,CAAAA,OAAO,CAAG3B,UAAU,EAA1B,CAEA,GAAM4B,CAAAA,oBAAoB,CAAG,CACzBC,KAAK,CAAE,CACHC,IAAI,CAAE,CACFb,KAAK,CAAE,OADL,CADH,CADkB,CAA7B,CAQA,GAAMc,CAAAA,YAAY,0FAAG,iBAAOC,CAAP,gKACjBA,CAAC,CAACC,cAAF,GADiB,sBAGsBR,CAAAA,MAAM,CAACS,mBAAP,CAA2B,CAC9DC,IAAI,CAAE,MADwD,CAE9DhB,IAAI,CAAEO,OAAO,CAACU,UAAR,CAAmB7C,iBAAnB,CAAsCE,iBAAtC,CAAyDD,cAAzD,CAFwD,CAA3B,CAHtB,4CAGT6C,KAHS,uBAGTA,KAHS,CAGFC,aAHE,uBAGFA,aAHE,CAQjB,GAAI,CAACD,KAAL,CAAY,CACR,GAAI,CACAE,UAAU,CAAC,UAAM,CACbZ,OAAO,CAACa,IAAR,CAAa,kBAAb,EACH,CAFS,CAEP,IAFO,CAAV,CAGApC,UAAU,CAAC,IAAD,CAAV,CACA;AAEAqC,KAAK,CAAC,8CAAD,CAAiD,CAClDC,MAAM,CAAE,MAD0C,CAElDC,IAAI,CAAE,MAF4C,CAGlDC,OAAO,CAAE,CACL,8BAA8B,GADzB,CAEL,eAAgB,kBAFX,CAHyC,CAOlDC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAezB,QAAf,CAP4C,CAAjD,CAAL,CAQG0B,IARH,CAQQ,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EARhB,EASKF,IATL,CASU,SAAAG,IAAI,CAAI,CACVC,OAAO,CAACC,GAAR,CAAY,UAAZ,CAAwBF,IAAxB,EACH,CAXL,EAYKG,KAZL,CAYW,SAACjB,KAAD,CAAW,CACde,OAAO,CAACf,KAAR,CAAc,QAAd,CAAwBA,KAAxB,EACH,CAdL,EAiBH,CAAC,MAAOA,KAAP,CAAc,CACZ;AACA/B,SAAS,CAAC,CACND,MAAM,CAAEgC,KADF,CAAD,CAAT,CAGH,CACJ,CAvCgB,sDAAH,kBAAZN,CAAAA,YAAY,4CAAlB,CAyCE;AAEF1C,SAAS,CAAC,UAAM,CACZ,GAAI0B,QAAQ,EAAI,IAAZ,EAAoBA,QAAQ,EAAI,GAApC,CAAyC,CACrCM,gBAAgB,CAAC,CACbL,eAAe,CAAE,uBADJ,CAEbC,KAAK,CAAE,OAFM,CAGbC,SAAS,CAAE,gBAHE,CAIbC,IAAI,CAAE,WAJO,CAAD,CAAhB,CAMH,CACJ,CATQ,CASN,EATM,CAAT,CAUA,mBACI,sCACI,YAAK,SAAS,WAAKC,aAAa,CAACJ,eAAnB,eAAd,UACKS,MAAM,cAEH,oCACI,WAAI,SAAS,CAAC,2BAAd,CAA0C,KAAK,CAAE,CAAE8B,SAAS,CAAE,QAAb,CAAuBC,SAAS,CAAE,MAAlC,CAA0CvC,KAAK,CAAEG,aAAa,CAACH,KAA/D,CAAjD,UAA0HZ,MAAM,CAACA,MAAjI,EADJ,cAEI,cAAM,QAAQ,CAAE0B,YAAhB,CAA8B,SAAS,CAAEX,aAAa,CAACD,IAAvD,4BAEI,aAAK,SAAS,CAAC,UAAf,wBACI,cAAO,KAAK,CAAE,CAAEF,KAAK,CAAEG,aAAa,CAACH,KAAvB,CAAd,CAA8C,EAAE,CAAC,eAAjD,oCADJ,cAEI,YAAK,EAAE,CAAC,UAAR,uBACI,KAAC,iBAAD,EAAmB,OAAO,CAAEW,oBAA5B,EADJ,EAFJ,GAFJ,cASI,aAAK,SAAS,CAAC,aAAf,wBACI,aAAK,SAAS,CAAC,UAAf,wBACI,cAAO,KAAK,CAAE,CAAEX,KAAK,CAAEG,aAAa,CAACH,KAAvB,CAAd,wBADJ,cAEI,YAAK,EAAE,CAAC,YAAR,uBACI,KAAC,iBAAD,EAAmB,OAAO,CAAEW,oBAA5B,EADJ,EAFJ,GADJ,cAQI,aAAK,SAAS,CAAC,UAAf,wBACI,cAAO,KAAK,CAAE,CAAEX,KAAK,CAAEG,aAAa,CAACH,KAAvB,CAAd,iBADJ,cAEI,YAAK,EAAE,CAAC,KAAR,uBACI,KAAC,cAAD,EAAgB,OAAO,CAAEW,oBAAzB,EADJ,EAFJ,GARJ,cAcI,kCACI,YAAK,SAAS,CAAC,QAAf,CAAwB,GAAG,CAAE6B,cAA7B,CAA6C,GAAG,CAAC,iBAAjD,EADJ,EAdJ,GATJ,cA2BI,YAAK,SAAS,CAAC,qBAAf,uBACI,aAAK,SAAS,CAAC,gBAAf,6BAEI,YAAK,SAAS,CAAC,MAAf,CAAsB,GAAG,CAAE7D,IAA3B,EAFJ,cAGI,UAAG,KAAK,CAAE,CAAEqB,KAAK,CAAEG,aAAa,CAACH,KAAvB,CAAV,4BAHJ,GADJ,EA3BJ,cAqCI,YAAK,SAAS,CAAC,wBAAf,uBACI,cAAO,KAAK,CAAEd,OAAO,CAAG,CAAEc,KAAK,CAAE,OAAT,CAAkByC,MAAM,CAAE,4BAA1B,CAAH,CAA8D,CAAEzC,KAAK,CAAE,SAAT,CAAoByC,MAAM,CAAE,8BAA5B,CAAnF,CAAiJ,SAAS,WAAKtC,aAAa,CAACF,SAAnB,qBAA1J,CAA2M,IAAI,CAAC,QAAhN,CAAyN,KAAK,CAAEf,OAAO,CAAG,WAAH,CAAiB,SAAxP,EADJ,EArCJ,GAFJ,GAFG,cAiDH,KAAC,OAAD,IAlDR,EADJ,EADJ,CAyDH,CApJD,CAqJA,cAAeD,CAAAA,aAAf","sourcesContent":["import React, { useState, useContext, useEffect } from 'react'\nimport { PaymentContext } from '../Context/PaymentContext'\nimport { CardNumberElement, CardCvcElement, CardExpiryElement, useElements, useStripe } from '@stripe/react-stripe-js'\nimport Lock from '../Assets/lock.png'\nimport CreditCardIcon from '../Assets/ccIcon.svg'\nimport axios from 'axios'\nimport '../Pages/pages.css'\nimport Loading from '../Components/Loading/Loading'\nimport { withRouter, useHistory } from 'react-router-dom'\nimport bodyParser from 'body-parser'\n\n\nconst StripePayment = () => {\n    // using state to keep track of stripe payment, show errors, and manange user interface\n    const [success, setSuccess] = useState(false)\n    const [status, setStatus] = useState({\n        status: \"Enter your card's information below\"\n    })\n    const [processing, setProcessing] = useState('')\n    const [disabled, setDisabled] = useState(true)\n    const [clientSecret, setClientSecrete] = useState('')\n    const { userInfo, totalbilling, darkMode } = useContext(PaymentContext)\n    const [darkModeStyle, setDarkModeStyle] = useState({\n        globalContainer: 'global_container',\n        color: '#585858',\n        submitBtn: 'submitBtn',\n        card: 'card_'\n    })\n\n    const api_data = {\n        'fullname': localStorage.getItem('fullname'),\n        'license_plate': localStorage.getItem('license'),\n        'set_time': localStorage.getItem('startTime'),\n        'exp_time': localStorage.getItem('expTime'),\n        'location_id': localStorage.getItem('lot'),\n        'paid': localStorage.getItem('total')\n    }\n\n    const stripe = useStripe()\n    const element = useElements()\n    const history = useHistory()\n\n    const CARD_ELEMENT_OPTIONS = {\n        style: {\n            base: {\n                color: 'white'\n            }\n        }\n    }\n\n    const handleSubmit = async (e) => {\n        e.preventDefault()\n\n        const { error, paymentMethod } = await stripe.createPaymentMethod({\n            type: 'card',\n            card: element.getElement(CardNumberElement, CardExpiryElement, CardCvcElement),\n        })\n\n        if (!error) {\n            try {\n                setTimeout(() => {\n                    history.push('/remaining-time/')\n                }, 2000)\n                setSuccess(true)\n                // const { id } = paymentMethod\n\n                fetch('https://osparking.pythonanywhere.com/visitor', {\n                    method: 'POST',\n                    mode: 'cors',\n                    headers: {\n                        'Access-Control-Allow-Origin':'*',\n                        'Content-Type': 'application/json'\n                    },\n                    body: JSON.stringify(api_data)\n                }).then(response => response.json())\n                    .then(data => {\n                        console.log('Success:', data);\n                    })\n                    .catch((error) => {\n                        console.error('Error:', error);\n                    });\n\n\n            } catch (error) {\n                // Change the title information\n                setStatus({\n                    status: error\n                })\n            }\n        }\n\n    } // end of handle submit\n\n    useEffect(() => {\n        if (darkMode >= 1800 || darkMode <= 600) {\n            setDarkModeStyle({\n                globalContainer: 'global_container_dark',\n                color: 'white',\n                submitBtn: 'submitBtn_dark',\n                card: 'card_dark'\n            })\n        }\n    }, [])\n    return (\n        <>\n            <div className={`${darkModeStyle.globalContainer} choose_lot`}>\n                {stripe ?\n\n                    <div>\n                        <h1 className='global_content_title slim' style={{ textAlign: 'center', marginTop: '-50%', color: darkModeStyle.color }}>{status.status}</h1>\n                        <form onSubmit={handleSubmit} className={darkModeStyle.card}> {/* this should be a form */}\n                            {/* Enter your card numner */}\n                            <div className='stacked_'>\n                                <label style={{ color: darkModeStyle.color }} id='CCnumberLabel'>Enter Your Card Number</label>\n                                <div id='CCnumber'>\n                                    <CardNumberElement options={CARD_ELEMENT_OPTIONS} />\n                                </div>\n                            </div>\n                            {/* Expiration CVC & Icon */}\n                            <div className='auth_holder'>\n                                <div className='stacked_'>\n                                    <label style={{ color: darkModeStyle.color }}>Expiration</label>\n                                    <div id='expiration'>\n                                        <CardExpiryElement options={CARD_ELEMENT_OPTIONS} />\n                                    </div>\n\n                                </div>\n                                <div className='stacked_'>\n                                    <label style={{ color: darkModeStyle.color }}>CVC</label>\n                                    <div id='cvc'>\n                                        <CardCvcElement options={CARD_ELEMENT_OPTIONS} />\n                                    </div>\n                                </div>\n                                <div>\n                                    <img className='ccIcon' src={CreditCardIcon} alt='creditCard_logo'></img>\n                                </div>\n                            </div>\n                            <div className='securePaymentHolder'>\n                                <div className='securePayment_'>  {/* display flex */}\n                                    {/* image */}\n                                    <img className='lock' src={Lock}></img>\n                                    <p style={{ color: darkModeStyle.color }}>Secure Payment</p>\n                                    {/* text info */}\n                                </div>\n                            </div>\n\n                            {/* Button here */}\n                            <div className='ccCardSubmissionHolder'>\n                                <input style={success ? { color: 'green', border: '1px solid green !important' } : { color: '#FF5759', border: '1px solid #FF5759 !important' }} className={`${darkModeStyle.submitBtn} ccCardSubmission`} type='submit' value={success ? 'Approved!' : 'Pay Now'}></input>\n                            </div>\n\n\n                        </form>\n                    </div>\n                    :\n                    <Loading />\n                }\n            </div>\n        </>\n    )\n}\nexport default StripePayment;\n\n"]},"metadata":{},"sourceType":"module"}