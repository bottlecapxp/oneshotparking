{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useCircularDrag = void 0;\n\nvar react_1 = require(\"react\");\n\nvar _1 = require(\"./\");\n\nfunction useCircularDrag(ref) {\n  var _a = _1.useCircularInputContext(),\n      onChange = _a.onChange,\n      onChangeEnd = _a.onChangeEnd,\n      getValueFromPointerEvent = _a.getValueFromPointerEvent;\n\n  var _b = react_1.useState(false),\n      isDragging = _b[0],\n      setDragging = _b[1];\n\n  var handleStart = react_1.useCallback(function (e) {\n    if (!onChange) return;\n    stopEvent(e);\n    setDragging(true);\n    var nearestValue = getValueFromPointerEvent(e);\n    onChange(nearestValue);\n  }, [onChange, setDragging, getValueFromPointerEvent]);\n  var handleMove = react_1.useCallback(function (e) {\n    stopEvent(e);\n    var nearestValue = getValueFromPointerEvent(e);\n    onChange(nearestValue);\n  }, [onChange, getValueFromPointerEvent]);\n  var handleEnd = react_1.useCallback(function (e) {\n    stopEvent(e);\n    setDragging(false);\n    if (!onChangeEnd) return;\n    var nearestValue = getValueFromPointerEvent(e);\n    onChangeEnd(nearestValue);\n  }, [onChangeEnd, getValueFromPointerEvent]); // we can't just use React for this due to needing { passive: false } to prevent touch devices scrolling\n\n  react_1.useEffect(function () {\n    var node = ref.current;\n    if (!node) return;\n    addStartListeners(node, handleStart);\n    return function () {\n      if (!node) return;\n      removeStartListeners(node, handleStart);\n    };\n  }, [ref, handleStart]);\n  react_1.useEffect(function () {\n    if (!isDragging) return;\n    addListeners(handleMove, handleEnd);\n    return function () {\n      removeListeners(handleMove, handleEnd);\n    };\n  }, [isDragging, handleMove, handleEnd]);\n  return {\n    isDragging: isDragging\n  };\n}\n\nexports.useCircularDrag = useCircularDrag;\n\nfunction addStartListeners(element, onStart) {\n  element.addEventListener('mousedown', onStart, {\n    passive: false\n  });\n  element.addEventListener('touchstart', onStart, {\n    passive: false\n  });\n}\n\nfunction removeStartListeners(element, onStart) {\n  element.removeEventListener('mousedown', onStart);\n  element.removeEventListener('touchstart', onStart);\n}\n\nfunction addListeners(onMove, onEnd) {\n  document.addEventListener('mousemove', onMove, {\n    passive: false\n  });\n  document.addEventListener('touchmove', onMove, {\n    passive: false\n  });\n  document.addEventListener('mouseup', onEnd, {\n    passive: false\n  });\n  document.addEventListener('touchend', onEnd, {\n    passive: false\n  });\n}\n\nfunction removeListeners(onMove, onEnd) {\n  document.removeEventListener('mousemove', onMove);\n  document.removeEventListener('touchmove', onMove);\n  document.removeEventListener('mouseup', onEnd);\n  document.removeEventListener('touchend', onEnd);\n}\n\nvar stopEvent = function (e) {\n  e.stopPropagation();\n\n  if (e.cancelable) {\n    e.preventDefault();\n  }\n};","map":{"version":3,"sources":["../src/useCircularDrag.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useCircularDrag = void 0;\nvar react_1 = require(\"react\");\nvar _1 = require(\"./\");\nfunction useCircularDrag(ref) {\n    var _a = _1.useCircularInputContext(), onChange = _a.onChange, onChangeEnd = _a.onChangeEnd, getValueFromPointerEvent = _a.getValueFromPointerEvent;\n    var _b = react_1.useState(false), isDragging = _b[0], setDragging = _b[1];\n    var handleStart = react_1.useCallback(function (e) {\n        if (!onChange)\n            return;\n        stopEvent(e);\n        setDragging(true);\n        var nearestValue = getValueFromPointerEvent(e);\n        onChange(nearestValue);\n    }, [onChange, setDragging, getValueFromPointerEvent]);\n    var handleMove = react_1.useCallback(function (e) {\n        stopEvent(e);\n        var nearestValue = getValueFromPointerEvent(e);\n        onChange(nearestValue);\n    }, [onChange, getValueFromPointerEvent]);\n    var handleEnd = react_1.useCallback(function (e) {\n        stopEvent(e);\n        setDragging(false);\n        if (!onChangeEnd)\n            return;\n        var nearestValue = getValueFromPointerEvent(e);\n        onChangeEnd(nearestValue);\n    }, [onChangeEnd, getValueFromPointerEvent]);\n    // we can't just use React for this due to needing { passive: false } to prevent touch devices scrolling\n    react_1.useEffect(function () {\n        var node = ref.current;\n        if (!node)\n            return;\n        addStartListeners(node, handleStart);\n        return function () {\n            if (!node)\n                return;\n            removeStartListeners(node, handleStart);\n        };\n    }, [ref, handleStart]);\n    react_1.useEffect(function () {\n        if (!isDragging)\n            return;\n        addListeners(handleMove, handleEnd);\n        return function () {\n            removeListeners(handleMove, handleEnd);\n        };\n    }, [isDragging, handleMove, handleEnd]);\n    return { isDragging: isDragging };\n}\nexports.useCircularDrag = useCircularDrag;\nfunction addStartListeners(element, onStart) {\n    element.addEventListener('mousedown', onStart, { passive: false });\n    element.addEventListener('touchstart', onStart, { passive: false });\n}\nfunction removeStartListeners(element, onStart) {\n    element.removeEventListener('mousedown', onStart);\n    element.removeEventListener('touchstart', onStart);\n}\nfunction addListeners(onMove, onEnd) {\n    document.addEventListener('mousemove', onMove, { passive: false });\n    document.addEventListener('touchmove', onMove, { passive: false });\n    document.addEventListener('mouseup', onEnd, { passive: false });\n    document.addEventListener('touchend', onEnd, { passive: false });\n}\nfunction removeListeners(onMove, onEnd) {\n    document.removeEventListener('mousemove', onMove);\n    document.removeEventListener('touchmove', onMove);\n    document.removeEventListener('mouseup', onEnd);\n    document.removeEventListener('touchend', onEnd);\n}\nvar stopEvent = function (e) {\n    e.stopPropagation();\n    if (e.cancelable) {\n        e.preventDefault();\n    }\n};\n//# sourceMappingURL=useCircularDrag.js.map"]},"metadata":{},"sourceType":"script"}